server:
  port: 7001

spring:
  application:
    name: cpms-server-gateway
    pathPrefix: gw-server
  profiles:
    active: @profiles.active@
    include: system

  cloud:
    nacos:
      discovery:
        server-addr: 127.0.0.1:8858
    gateway:
      discovery:
        locator:
          enabled: true
      routes:
        - id: cpms-server-auth
          uri: lb://cpms-server-auth
          order: 1
          predicates:
            - Path=/${spring.application.pathPrefix}/authMicroservice/**
          filters:
            - StripPrefix=1
            - name: Hystrix
              args:
                name: defaultfallback
                fallbackUri: 'forward:/defaultfallback'
        - id: cpms-server-system
          uri: lb://cpms-server-system
          order: 2
          predicates:
            - Path=/${spring.application.pathPrefix}/systemMicroservice/**
          filters:
            - StripPrefix=1
            - name: Hystrix
              args:
                name: defaultfallback
                fallbackUri: 'forward:/defaultfallback'
        - id: cpms-server-log
          uri: lb://cpms-server-log
          order: 3
          predicates:
            - Path=/${spring.application.pathPrefix}/logMicroservice/**
          filters:
            - StripPrefix=1
            - name: Hystrix
              args:
                name: defaultfallback
                fallbackUri: 'forward:/defaultfallback'

ribbon:
  OkToRetryOnAllOperations: false
  ReadTimeout:  10000
  ConnectTimeout: 2000
  MaxAutoRetries: 0
  MaxAutoRetriesNextServer: 0
  http:
    client:
      enabled: true

hystrix:
  command:
    default:
      execution:
        timeout:
          enabled: true
        isolation:
          strategy: SEMAPHORE
          thread:
            timeoutInMilliseconds: 10000
  shareSecurityContext: true

cpms:
  jwt-secretKey: cpms
  jwt-token-expire: 3600*2*1000  # token有效期，单位：毫秒