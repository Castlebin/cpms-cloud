<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cpms.system.modules.sys.mapper.SysPostMapper">

    <select id="listPostCount" parameterType="com.cpms.system.modules.sys.dto.ListPostDTO" resultType="java.lang.Integer">
        SELECT
        count(1)
        FROM
        cpms_system_post p
        LEFT JOIN cpms_system_dept d ON d.dept_Id = p.dept_id
        <where>
            p.del_flag = 0
            <if test="postName !=null and postName !=''">
                and p.post_name like CONCAT('%',#{postName},'%' )
            </if>
            <if test="deptId !=null ">
                and p.dept_id = #{deptId}
            </if>
            <if test="tenantId !=null ">
                and d.tenant_id = #{tenantId}
            </if>
        </where>
    </select>

    <select id="listPost" parameterType="com.cpms.system.modules.sys.dto.ListPostDTO" resultType="com.cpms.system.modules.sys.vo.SysPostVO">
        SELECT
        p.post_id,
        p.dept_id,
        p.post_name,
        d.dept_name,
        p.create_time,
        p.update_time,
        p.create_by,
        p.update_by
        FROM
        cpms_system_post p
        LEFT JOIN cpms_system_dept d ON d.dept_Id = p.dept_id
        <where>
            p.del_flag = 0
            <if test="postName !=null and postName !=''">
                and p.post_name like CONCAT('%',#{postName},'%' )
            </if>
            <if test="deptId !=null ">
                and p.dept_id = #{deptId}
            </if>
            <if test="tenantId !=null ">
                and d.tenant_id = #{tenantId}
            </if>
        </where>
        limit #{startIndex},#{pageSize}
    </select>
</mapper>